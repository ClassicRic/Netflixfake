{% extends 'base.html' %}

{% block titulo %}
HomeFilmes • FortFlix
{% endblock %}

{% block content %}

{# ================================ #}
{#  BANNER DE DESTAQUE (AULA 29)   #}
{# ================================ #}

{% if filme_destaque %}
<div class="relative w-full h-[70vh] rounded-xl overflow-hidden shadow-xl mb-12">

    <img src="{{ filme_destaque.thumb.url }}"
         class="w-full h-full object-cover">

    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent p-10 flex flex-col justify-end">

        <h1 class="text-4xl md:text-5xl font-bold mb-4">
            {{ filme_destaque.titulo }}
        </h1>

        <p class="max-w-2xl text-gray-200 text-lg mb-6">
            {{ filme_destaque.descricao|truncatewords:25 }}
        </p>

        <a href="{% url 'filme:detalhesfilme' filme_destaque.id %}"
           class="bg-red-600 px-6 py-3 rounded-xl text-lg font-semibold
                  hover:bg-red-500 transition w-fit shadow-lg">
            ▶ Assistir Agora
        </a>

    </div>

</div>
{% endif %}


<div class="py-10 max-w-6xl mx-auto px-4">


    {# ======================================== #}
    {# SEÇÃO 1 - FILMES RECENTES                #}
    {# ======================================== #}
    <h2 class="text-3xl font-bold mb-6">Novos</h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-12">
        {% for filme in lista_filmes_recentes %}
            <a href="{% url 'filme:detalhesfilme' filme.pk %}"
               class="bg-white/5 p-4 rounded-xl shadow-md hover:scale-[1.03] transition transform block">

                <img src="{{ filme.thumb.url }}"
                     alt="{{ filme.titulo }}"
                     class="w-full h-64 object-cover rounded-lg mb-3">

                <h2 class="text-xl font-semibold mb-1 hover:underline">
                    {{ filme.titulo }}
                </h2>

                <p class="text-gray-300 text-sm mb-2">
                    {{ filme.descricao|truncatewords:12 }}
                </p>

                <span class="text-xs bg-red-600 px-2 py-1 rounded-md">
                    {{ filme.categoria }}
                </span>
            </a>
        {% empty %}
            <p class="text-gray-400">Nenhum filme recente.</p>
        {% endfor %}
    </div>


    {# ======================================== #}
    {# SEÇÃO 2 - FILMES EM ALTA                 #}
    {# ======================================== #}
    <h2 class="text-3xl font-bold mb-6">Em Alta</h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-12">
        {% for filme in lista_filmes_em_alta %}
            <a href="{% url 'filme:detalhesfilme' filme.pk %}"
               class="bg-white/5 p-4 rounded-xl shadow-md hover:scale-[1.03] transition transform block">

                <img src="{{ filme.thumb.url }}"
                     alt="{{ filme.titulo }}"
                     class="w-full h-64 object-cover rounded-lg mb-3">

                <h2 class="text-xl font-semibold mb-1 hover:underline">
                    {{ filme.titulo }}
                </h2>

                <p class="text-gray-300 text-sm mb-2">
                    {{ filme.descricao|truncatewords:12 }}
                </p>

                <span class="text-xs bg-red-600 px-2 py-1 rounded-md">
                    {{ filme.categoria }}
                </span>
            </a>
        {% empty %}
            <p class="text-gray-400">Nenhum filme em alta agora.</p>
        {% endfor %}
    </div>


    {# ======================================== #}
    {# SEÇÃO 3 - TODOS OS FILMES                #}
    {# ======================================== #}
    <h2 class="text-3xl font-bold mb-6">Todos os Filmes</h2>

    {% if lista_filmes %}
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">

            {% for filme in lista_filmes %}
                <a href="{% url 'filme:detalhesfilme' filme.pk %}"
                   class="bg-white/5 p-4 rounded-xl shadow-md hover:scale-[1.03] transition transform block">

                    <img src="{{ filme.thumb.url }}"
                         alt="{{ filme.titulo }}"
                         class="w-full h-64 object-cover rounded-lg mb-3">

                    <h2 class="text-xl font-semibold mb-1 hover:underline">
                        {{ filme.titulo }}
                    </h2>

                    <p class="text-gray-300 text-sm mb-2">
                        {{ filme.descricao|truncatewords:12 }}
                    </p>

                    <span class="text-xs bg-red-600 px-2 py-1 rounded-md">
                        {{ filme.categoria }}
                    </span>

                </a>
            {% endfor %}

        </div>

    {% else %}
        <p class="text-gray-400 text-lg">Nenhum filme cadastrado ainda.</p>
    {% endif %}

</div>

<h2 class="text-2xl font-semibold mb-4">Continuar Assistindo</h2>

<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-12">
    {% for filme in request.user.filmes_vistos.all %}
        <a href="{% url 'filme:detalhesfilme' filme.pk %}"
           class="bg-white/5 p-4 rounded-xl shadow-md hover:scale-[1.02] transition transform block">

            <img src="{{ filme.thumb.url }}"
                 alt="{{ filme.titulo }}"
                 class="w-full h-64 object-cover rounded-lg mb-3">

            <h2 class="text-xl font-semibold mb-1 hover:underline">
                {{ filme.titulo }}
            </h2>

            <p class="text-gray-300 text-sm mb-2">
                {{ filme.descricao }}
            </p>

            <span class="text-xs bg-red-600 px-2 py-1 rounded-md">
                {{ filme.categoria }}
            </span>
        </a>
    {% empty %}
        <p class="text-gray-400">Você ainda não viu nenhum filme.</p>
    {% endfor %}
</div>


{% endblock %}
